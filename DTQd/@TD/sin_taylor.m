function res = sin_taylor(a)
  % written by P. B. Du & H. Jiang NUDT 07/01/2013

inv_fact(1)=TD(1.66666666666666657e-01,  9.25185853854297066e-18, 5.13581318503262866e-34);
inv_fact(2)=TD(4.16666666666666644e-02,  2.31296463463574266e-18, 1.28395329625815716e-34);
inv_fact(3)=TD(8.33333333333333322e-03,  1.15648231731787138e-19, 1.60494162032269652e-36);
inv_fact(4)=TD(1.38888888888888894e-03, -5.30054395437357706e-20,  -1.73868675534958776e-36);
inv_fact(5)=TD(1.98412698412698413e-04,  1.72095582934207053e-22, 1.49269123913941271e-40);
inv_fact(6)=TD(2.48015873015873016e-05,  2.15119478667758816e-23, 1.86586404892426588e-41);
inv_fact(7)=TD(2.75573192239858925e-06, -1.85839327404647208e-22, 8.49175460488199287e-39);
inv_fact(8)=TD(2.75573192239858883e-07,  2.37677146222502973e-23, -3.26318890334088294e-40);
inv_fact(9)=TD(2.50521083854417202e-08, -1.44881407093591197e-24, 2.04267351467144546e-41);
inv_fact(10)=TD(2.08767569878681002e-09, -1.20734505911325997e-25,  1.70222792889287100e-42);
inv_fact(11)=TD(1.60590438368216133e-10,  1.25852945887520981e-26,  -5.31334602762985031e-43);
inv_fact(12)=TD(1.14707455977297245e-11,  2.06555127528307454e-28, 6.88907923246664603e-45);
inv_fact(13)=TD(7.64716373181981641e-13,  7.03872877733453001e-30, -7.82753927716258345e-48);
inv_fact(14)=TD(4.77947733238738525e-14,  4.39920548583408126e-31, -4.89221204822661465e-49);
inv_fact(15)=TD(2.81145725434552060e-15,  1.65088427308614326e-31, -2.87777179307447918e-50);

if a.complex
    error('we only consider real number now');
end

if iszero(a)
      res=TD(0);
      return
end

thresh=0.5*double(TD('eps')).*abs(double(a));

x=-sqr(a);
s=a;
p=a;
t=a.*sqr(a).*inv_fact(1);
i=1;

while(i<16 && abs(double(t))>thresh)
    p=p.*x;
    t=p.*inv_fact(i);
    s=s+t;
    i=i+2;
end

res=s;